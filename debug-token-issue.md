## ðŸ› LIFF Token éŽæœŸå•é¡Œèª¿è©¦æŒ‡å—

### ðŸ“‹ å•é¡Œç¾è±¡
ç”¨æˆ¶ç«‹åˆ»ç™»å…¥å¾Œå†æ¬¡æäº¤è¡¨å–®ï¼Œä»ç„¶å‡ºç¾ "Token expired" éŒ¯èª¤ï¼Œä¸¦è·³å›žç™»å…¥é é¢ã€‚

### ðŸ”§ å·²åŠ å…¥çš„èª¿è©¦åŠŸèƒ½

#### å¾Œç«¯èª¿è©¦
1. **æ”¾å¯¬æ™‚é–“å®¹å¿åº¦**: åŠ å…¥ 5 åˆ†é˜ç·©è¡æ™‚é–“è™•ç†æ™‚é˜åå·®
2. **è©³ç´°æ—¥èªŒ**: è¨˜éŒ„ Token éŽæœŸçš„å…·é«”æ™‚é–“å·®
3. **æˆåŠŸé©—è­‰æ—¥èªŒ**: è¨˜éŒ„æˆåŠŸé©—è­‰çš„ç”¨æˆ¶ ID

#### å‰ç«¯èª¿è©¦
1. **Token è³‡è¨Šè¨˜éŒ„**: é¡¯ç¤º Token çš„éŽæœŸæ™‚é–“å’Œå‰©é¤˜æ™‚é–“
2. **API éŒ¯èª¤è©³æƒ…**: è¨˜éŒ„å®Œæ•´çš„ API å›žæ‡‰éŒ¯èª¤
3. **Token è§£ç¢¼æª¢æŸ¥**: åœ¨æäº¤å‰æª¢æŸ¥ Token æ˜¯å¦å³å°‡éŽæœŸ

### ðŸ“Š èª¿è©¦æ­¥é©Ÿ

1. **é‡æ–°éƒ¨ç½²** åŒ…å«èª¿è©¦è³‡è¨Šçš„ç‰ˆæœ¬
2. **é–‹å•Ÿç€è¦½å™¨é–‹ç™¼è€…å·¥å…·**
3. **å˜—è©¦æäº¤è¡¨å–®** ä¸¦æŸ¥çœ‹ Console è¼¸å‡º
4. **æª¢æŸ¥å¾Œç«¯æ—¥èªŒ** æŸ¥çœ‹ Token é©—è­‰çš„è©³ç´°è³‡è¨Š

### ðŸ” é æœŸçš„èª¿è©¦è¼¸å‡º

#### å‰ç«¯ Console
```javascript
ID Token obtained: eyJhbGciOiJSUzI1Ni...
Token info: {
  currentTime: 1692259200,
  exp: 1692262800,
  timeToExpiry: 3600,
  sub: "U1234567890abcdef"
}
```

#### å¾Œç«¯æ—¥èªŒ
```
INFO: Token verified successfully for user: U1234567890abcdef
æˆ–
WARNING: Token expired: current_time=1692259200, exp=1692258000, diff=1200
```

### ðŸš¨ å¯èƒ½çš„åŽŸå› 

1. **æ™‚é˜åŒæ­¥å•é¡Œ**: ä¼ºæœå™¨å’Œ LINE æœå‹™å™¨æ™‚é–“ä¸åŒæ­¥
2. **Token ç”Ÿå‘½é€±æœŸ**: LIFF Token çš„å¯¦éš›æœ‰æ•ˆæœŸæ¯”é æœŸçŸ­
3. **é‡æ–°ç™»å…¥é‚è¼¯**: é‡æ–°ç™»å…¥å¾Œæ²’æœ‰æ­£ç¢ºç²å–æ–°çš„ Token
4. **LIFF App è¨­å®š**: Scope æˆ–å…¶ä»–è¨­å®šå¯èƒ½å½±éŸ¿ Token æœ‰æ•ˆæ€§

### ðŸ”§ è‡¨æ™‚è§£æ±ºæ–¹æ¡ˆ

å¦‚æžœèª¿è©¦å¾Œç™¼ç¾æ˜¯æ™‚é–“åŒæ­¥å•é¡Œï¼Œå¯ä»¥æš«æ™‚ç§»é™¤éŽæœŸæª¢æŸ¥ï¼š

```python
# åœ¨ app/core/auth.py ä¸­æš«æ™‚è¨»è§£æŽ‰éŽæœŸæª¢æŸ¥
# if current_time > (exp + time_buffer):
#     logger.warning(...)
#     raise ValueError("Token expired")
```

### âš¡ å¿«é€Ÿæ¸¬è©¦

1. éƒ¨ç½²èª¿è©¦ç‰ˆæœ¬
2. æ¸¬è©¦ä¸¦æŸ¥çœ‹ Console å’Œæ—¥èªŒ
3. å›žå ±å…·é«”çš„æ™‚é–“å·®æ•¸æ“š
4. æ ¹æ“šæ•¸æ“šèª¿æ•´è§£æ±ºæ–¹æ¡ˆ
