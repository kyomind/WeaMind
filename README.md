[![WeaMind CI](https://github.com/kyomind/WeaMind/actions/workflows/ci.yml/badge.svg)](https://github.com/kyomind/WeaMind/actions/workflows/ci.yml)
[![CodeQL](https://github.com/kyomind/WeaMind/actions/workflows/codeql.yml/badge.svg)](https://github.com/kyomind/WeaMind/security/code-scanning)
[![codecov](https://codecov.io/gh/kyomind/WeaMind/branch/main/graph/badge.svg)](https://codecov.io/gh/kyomind/WeaMind)
[![SonarCloud](https://sonarcloud.io/api/project_badges/measure?project=kyomind_WeaMind&metric=sqale_rating)](https://sonarcloud.io/summary/overall?id=kyomind_WeaMind)
[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/kyomind/WeaMind)
[![Ruff](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/ruff/main/assets/badge/v2.json)](https://github.com/astral-sh/ruff)
[![uv](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/uv/main/assets/badge/v0.json)](https://github.com/astral-sh/uv)

A smart LINE bot for Taiwan weather updates. See [DeepWiki](https://deepwiki.com/kyomind/WeaMind) for details.

WeaMind æ˜¯ä¸€å€‹æ™ºæ…§å¤©æ°£ LINE Botï¼Œé€éç°¡å–®çš„æ“ä½œæˆ–æ–‡å­—æŸ¥è©¢ï¼Œæä¾›å³æ™‚å°ç£å¤©æ°£è³‡è¨Šã€‚

æœ¬æœå‹™å®Œå…¨**å…è²»**ï¼Œå¦‚æœå°ä½ æœ‰å¹«åŠ©ï¼Œæ­¡è¿[è´ŠåŠ©æˆ‘ä¸€æ¯å’–å•¡](https://portaly.cc/kyomind/support)ï¼Œæˆ–é»æ“Šå³ä¸Šè§’çš„ â­ï¸ æ”¯æŒæˆ‘ã€‚

## ä½¿ç”¨èªªæ˜

åŠ å…¥ WeaMind ç‚ºå¥½å‹å¾Œï¼Œé»æ“ŠèŠå¤©è¦–çª—ä¸‹æ–¹çš„ã€ŒåŠŸèƒ½é¸å–®ã€å³å¯é–‹å§‹ä½¿ç”¨ã€‚

![WeaMind](https://img.kyomind.tw/2352352we-min-20250929-222126.png)

### 1. æ™ºæ…§æ–‡å­—æœå°‹
- ç›´æ¥è¼¸å…¥ã€ŒäºŒç´šè¡Œæ”¿å€ã€åç¨±ï¼Œæ¯”å¦‚ã€Œ`å¤§å®‰å€`ã€ã€ã€Œ`æ°´ä¸Š`ã€ã€ã€Œ`ä¸­å£¢`ã€ç­‰ï¼Œå°‡é€²è¡Œåœ°åçš„æ¨¡ç³Šæ¯”å°ã€‚
- ç³»çµ±æœƒè‡ªå‹•è­˜åˆ¥ä¸¦å›å‚³è©²åœ°å€çš„å¤©æ°£è³‡è¨Šã€‚

### 2. è¨­å®šä½å®¶ã€å…¬å¸ï¼Œä¸€éµæŸ¥è©¢å¤©æ°£
- é€éã€Œ`è¨­å®šåœ°é»`ã€åŠŸèƒ½ï¼Œé å…ˆè¨­å®šå¸¸ç”¨åœ°å€ã€‚
- é»æ“Šã€Œ`æŸ¥ä½å®¶`ã€æˆ–ã€Œ`æŸ¥å…¬å¸`ã€ç«‹å³å–å¾—è©²åœ°å€çš„å®Œæ•´å¤©æ°£è³‡è¨Šã€‚

### 3. å¿«é€Ÿé‡è¤‡æŸ¥è©¢
- ã€Œ`æœ€è¿‘æŸ¥é`ã€æœƒè¨˜éŒ„æ‚¨æœ€è¿‘æŸ¥è©¢éçš„ **5 å€‹åœ°é»**ï¼ˆä¸å«ä½å®¶èˆ‡å…¬å¸ï¼‰ã€‚
- é»æ“Šå¾Œé‡æ–°æŸ¥è©¢ï¼Œç„¡éœ€é‡è¤‡è¼¸å…¥åœ°å€ã€‚

### 4. åœ°åœ–æŸ¥è©¢
- é»æ“Šã€Œ`åœ°åœ–æŸ¥è©¢`ã€æœƒé–‹å•Ÿ LINE åœ°åœ–ä»‹é¢ã€‚
- ç›´æ¥åœ¨åœ°åœ–ä¸Šé¸æ“‡ä½ç½®ï¼Œç³»çµ±æœƒè‡ªå‹•å–å¾—è©²åœ°é»è³‡è¨Šä¸¦æŸ¥è©¢ç•¶åœ°å¤©æ°£ã€‚
- ä¸é™æ–¼ç›®å‰æ‰€åœ¨ä½ç½®ï¼Œä½ å¯ä»¥æŸ¥è©¢**ä»»æ„åœ°é»**çš„å¤©æ°£ã€‚

## åŠ å…¥å¥½å‹ï¼Œé–‹å§‹ä½¿ç”¨

1. æƒæä¸‹æ–¹ QR Codeï¼ˆæ¨è–¦ï¼‰æˆ–æœå°‹ LINE ID `@370ndhmf` åŠ å…¥ WeaMindã€‚
2. ä½¿ç”¨åŠŸèƒ½é¸å–®é–‹å§‹æŸ¥è©¢å¤©æ°£è³‡è¨Šã€‚

ç«‹å³é«”é©—æ™ºæ…§å¤©æ°£æŸ¥è©¢ï¼Œè®“å¤©æ°£è³‡è¨Šéš¨æ‰‹å¯å¾—ï¼

![WeaMind QR Code](https://img.kyomind.tw/wea-qrcode-min-20250929-223022.png)

---

## é–‹ç™¼è€…æŠ€è¡“äº®é»

```mermaid
graph TB
    LINE[LINE Platform]
    REDIS[(Redis<br/>åˆ†æ•£å¼é–)]
    DB[(PostgreSQL<br/>ä¸»è³‡æ–™åº«)]
    DATA[weamind-data<br/>å¾®æœå‹™]

    subgraph FASTAPI["FastAPI LINE Bot App"]
        WEB[Webhook Handler]
        BG[Background Tasks]
    end

    LINE -->|Webhook| WEB
    WEB -->|Fast ACK<br/>æ•¸åæ¯«ç§’| LINE
    WEB -->|éé˜»å¡| BG
    BG -->|é¸æ“‡æ€§é–å®š| REDIS
    BG <-->|è³‡æ–™è®€å¯«| DB
        BG -->|å›æ‡‰ç”¨æˆ¶<br/>< 2 ç§’| LINE
    DATA -->|æ¯ 6 å°æ™‚<br/>ETL æ›´æ–°| DB
```

### ğŸš€ Fast ACK Webhook æ¶æ§‹
- **æ•¸åæ¯«ç§’ ACK**ï¼šWebhook Handler æ”¶åˆ°è«‹æ±‚å¾Œç«‹å³é©—è­‰ä¸¦å›æ‡‰ LINE Platformï¼Œé¿å…å¹³å°é‡é€
- **2 ç§’å…§å›æ‡‰ç”¨æˆ¶**ï¼šæ¡ç”¨ã€Œå¿«é€Ÿ ACKâ†’èƒŒæ™¯è™•ç†â†’å›æ‡‰ç”¨æˆ¶ã€çš„éåŒæ­¥æµç¨‹
- **èƒŒæ™¯ä»»å‹™è™•ç†**ï¼šä½¿ç”¨ FastAPI BackgroundTasksï¼Œé¿å…æ¥­å‹™é‚è¼¯é˜»å¡ ACK

### ğŸ”’ Redis åˆ†æ•£å¼é–
- **é˜²é‡è¤‡é»æ“Šä¿è­·**ï¼š2 ç§’é–å®šæ©Ÿåˆ¶ï¼Œé¿å…ç”¨æˆ¶å¿«é€Ÿé€£é»é€ æˆé‡è¤‡è™•ç†
- **æœå‹™å„ªå…ˆç­–ç•¥**ï¼šRedis ç•°å¸¸æ™‚è‡ªå‹•é™ç´šï¼Œç¢ºä¿æ ¸å¿ƒæœå‹™ä¸ä¸­æ–·
- **ç²¾æº–é–å®šç¯„åœ**ï¼šåƒ…å°æŒ‰éˆ•æ“ä½œåŠ é–ï¼Œä¸€èˆ¬æ–‡å­—æŸ¥è©¢ä¿æŒå¿«é€Ÿå›æ‡‰

### ğŸ—ï¸ Domain-Driven Design æ¶æ§‹
- **æ¸…æ™°é ˜åŸŸé‚Šç•Œ**ï¼š`core`ï¼ˆåŸºç¤è¨­æ–½ï¼‰ã€`user`ï¼ˆä½¿ç”¨è€…ç®¡ç†ï¼‰ã€`line`ï¼ˆLINE Botï¼‰ã€`weather`ï¼ˆå¤©æ°£æœå‹™ï¼‰
- **åˆ†å±¤æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šæŒ‰æ¥­å‹™é ˜åŸŸåŠƒåˆ†æ¨¡çµ„ï¼Œæ¶æ§‹æ¸…æ™°æ˜“æ“´å±•ï¼Œé©åˆåœ˜éšŠå”ä½œé–‹ç™¼
- **100% Type Hints è¦†è“‹**ï¼šä»¥ Pyright basic æ¨™æº–ï¼Œé”æˆå®Œæ•´å‹åˆ¥å®‰å…¨

### ğŸ§ª pytest å–®å…ƒæ¸¬è©¦é«”ç³»
- **94% æ¸¬è©¦è¦†è“‹ç‡**ï¼šé«˜è¦†è“‹ç‡ç¢ºä¿ç¨‹å¼ç¢¼å“è³ªèˆ‡ç©©å®šæ€§
- **32+ æ¸¬è©¦æª”æ¡ˆ**ï¼šæ¶µè“‹ coreã€lineã€weatherã€user å„é ˜åŸŸæ¨¡çµ„çš„å®Œæ•´æ¸¬è©¦
- **æ¸¬è©¦ç’°å¢ƒéš”é›¢**ï¼šSQLite è¨˜æ†¶é«”è³‡æ–™åº« + fixtures è¨­è¨ˆï¼Œç¢ºä¿æ¸¬è©¦ç¨ç«‹æ€§
- **è‡ªå‹•åŒ–è¦†è“‹ç‡**ï¼špytest-cov æ•´åˆï¼Œè‡ªå‹•ç”Ÿæˆè¦†è“‹ç‡å ±å‘Šä¸¦ä¸Šå‚³ Codecov

### ğŸ› ï¸ ç¾ä»£åŒ–é–‹ç™¼å·¥å…·éˆ
- **çµ±ä¸€ç’°å¢ƒç®¡ç†**ï¼šuv å¥—ä»¶ç®¡ç†ï¼Œçµ±ä¸€ `uv run` æŒ‡ä»¤åŸ·è¡Œï¼Œæ¶ˆé™¤ç’°å¢ƒå·®ç•°
- **å®Œæ•´ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥**ï¼šRuff éœæ…‹æª¢æŸ¥èˆ‡æ ¼å¼åŒ–ï¼Œç¢ºä¿ç¨‹å¼ç¢¼ä¸€è‡´æ€§
- **è‡ªå‹•åŒ–ç¨‹å¼ç¢¼æª¢æŸ¥**ï¼špre-commit hooks æ–¼ commit å‰è‡ªå‹•åŸ·è¡Œå“è³ªæª¢æŸ¥
- **å¤šé‡å®‰å…¨æƒæ**ï¼šBanditï¼ˆéœæ…‹å®‰å…¨ï¼‰ã€pip-auditï¼ˆCVE æª¢æŸ¥ï¼‰ã€detect-secretsï¼ˆæ•æ„Ÿè³‡æ–™é˜²è­·ï¼‰

### ğŸ”„ å®Œæ•´ CI Pipeline
- **å¤šå±¤ç´šç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥**ï¼šRuff â†’ Pyright â†’ Bandit â†’ pip-audit â†’ pytest ä¾åºåŸ·è¡Œ
- **å®¹å™¨åŒ–é©—è­‰**ï¼šæ¯æ¬¡ PR è‡ªå‹•é©—è­‰ Docker image å®Œæ•´æ€§
- **ä¸‰è»Œå®‰å…¨åˆ†æ**ï¼šä¸» CI æµç¨‹ + CodeQL + SonarCloud å¤šç¶­åº¦å®‰å…¨èˆ‡å“è³ªç›£æ§
- **è‡ªå‹•åŒ–ç™¼å¸ƒ**ï¼šGit tag è§¸ç™¼è‡ªå‹•ç‰ˆæœ¬ç™¼å¸ƒèˆ‡ release notes ç”Ÿæˆ

### ğŸ“¦ å®¹å™¨åŒ–èˆ‡éƒ¨ç½²
- **å¤šå±¤å¿«å– Docker è¨­è¨ˆ**ï¼šåˆ†å±¤å¿«å–æ©Ÿåˆ¶ï¼ˆä¾è³´å±¤ + æ‡‰ç”¨å±¤ï¼‰ï¼Œå¤§å¹…åŠ é€Ÿé‡å»ºæ™‚é–“
- **è‡ªå‹•åŒ–éƒ¨ç½²æµç¨‹**ï¼šMakefile æ•´åˆè³‡æ–™åº«å¥åº·æª¢æŸ¥ã€è‡ªå‹•é·ç§»ã€éŒ¯èª¤è™•ç†çš„å®Œæ•´éƒ¨ç½²æ©Ÿåˆ¶
- **å¤šç’°å¢ƒé…ç½®ç¹¼æ‰¿**ï¼šdev/prod ç’°å¢ƒé€é Docker Compose çµ„åˆå¯¦ç¾ç’°å¢ƒéš”é›¢èˆ‡é…ç½®è¤‡ç”¨

---

è©³ç´°æŠ€è¡“æ¶æ§‹è«‹åƒè€ƒï¼š
- [å°ˆæ¡ˆæ¶æ§‹](docs/Architecture-Code.md) - å®Œæ•´ç¨‹å¼ç¢¼æ¶æ§‹èªªæ˜
- [DeepWiki æŠ€è¡“æ–‡ä»¶](https://deepwiki.com/kyomind/WeaMind) - äº’å‹•å¼æŠ€è¡“æ¢ç´¢
